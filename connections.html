<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Connection Status - OpsLink</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="min-h-screen bg-gradient-to-br from-black via-zinc-900 to-black text-white flex items-center justify-center px-6">

  <div class="max-w-md w-full bg-zinc-900/80 border border-zinc-800 p-8 rounded-lg text-center shadow-xl">

    <!-- Icon -->
    <div id="icon" class="text-5xl mb-4">⏳</div>

    <!-- Title -->
    <h1 id="title" class="text-3xl font-bold mb-3"></h1>

    <!-- Description -->
    <p id="desc" class="text-zinc-400 mb-6"></p>

    <!-- Spinner -->
    <div id="spinner" class="flex justify-center mb-4">
      <div class="w-8 h-8 border-4 border-zinc-700 border-t-white rounded-full animate-spin"></div>
    </div>

    <!-- Redirect text -->
    <p class="text-sm text-zinc-500">
      Redirecting you back in <span id="countdown">3</span>s…
    </p>

  </div>

  <script>
    const params = new URLSearchParams(window.location.search);

    const platformRaw = params.get("platform") || "platform";
    const error = params.get("error");
    const message = params.get("message");

    const platform =
      platformRaw.charAt(0).toUpperCase() + platformRaw.slice(1);

    let seconds = 3;

    const icon = document.getElementById("icon");
    const title = document.getElementById("title");
    const desc = document.getElementById("desc");
    const spinner = document.getElementById("spinner");
    const countdown = document.getElementById("countdown");

    if (error) {
      icon.textContent = "✕";
      icon.classList.add("text-red-500");

      title.textContent = `${platform} Connection Failed`;
      title.classList.add("text-red-400");

      desc.textContent =
        message || "This account is not approved to use this connection.";

      spinner.style.display = "none";
    } else {
      icon.textContent = "✓";
      icon.classList.add("text-green-500");

      title.textContent = `${platform} Connected!`;

      desc.textContent =
        "Your account has been successfully connected.";
    }

    countdown.textContent = seconds;

    const interval = setInterval(() => {
      seconds--;
      countdown.textContent = seconds;

      if (seconds <= 0) {
        clearInterval(interval);
        window.location.replace("index.html");
      }
    }, 1000);
  </script>

</body>
</html>
