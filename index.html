<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Basics -->
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>OpsLink Servers</title>

  <!-- SEO -->
  <meta name="description" content="OpsLink Servers is a modern Discord server directory built for discovery, trust, and community growth.">
  <meta name="robots" content="index, follow">

  <!-- Theme -->
  <meta name="theme-color" content="#0a0a0a">
  <meta name="color-scheme" content="dark">

  <!-- Open Graph -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="OpsLink Servers">
  <meta property="og:description" content="Discover and explore Discord communities with a clean, modern server directory.">
  <meta property="og:url" content="https://opslink.example">
  <meta property="og:image" content="https://cdn.discordapp.com/attachments/1463693698893221932/1466789150073291035/9Mia9QJ.png">
  <meta property="og:image:width" content="512">
  <meta property="og:image:height" content="512">
  <meta property="og:site_name" content="OpsLink">

  <!-- Twitter / X -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="OpsLink Servers">
  <meta name="twitter:description" content="A clean, modern Discord server directory focused on quality communities.">
  <meta name="twitter:image" content="https://cdn.discordapp.com/attachments/1463693698893221932/1466789150073291035/9Mia9QJ.png">

  <!-- Icons -->
  <link rel="icon" type="image/png" href="https://cdn.discordapp.com/attachments/1463693698893221932/1466789150073291035/9Mia9QJ.png">
  <link rel="apple-touch-icon" href="https://cdn.discordapp.com/attachments/1463693698893221932/1466789150073291035/9Mia9QJ.png">

  <!-- Browser polish -->
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="referrer" content="strict-origin-when-cross-origin">

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="min-h-screen text-white overflow-x-hidden animated-bg">
  
<style>
.animated-bg {
  background: linear-gradient(
    270deg,
    #000000,
    #7f1d1d,
    #dc2626,
    #000000
  );
  background-size: 400% 400%;
  animation:
    gradientMove 18s ease infinite,
    pulseGlow 6s ease-in-out infinite;
}

@keyframes gradientMove {
  0%   { background-position: 0% 50%; }
  50%  { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}

@keyframes pulseGlow {
  0%, 100% {
    filter: brightness(1);
  }
  50% {
    filter: brightness(1.08);
  }
}
</style>
  
  <!-- Navbar above hero, centered -->
  <nav class="flex flex-col items-center px-10 py-6">
    <div class="text-2xl font-semibold tracking-wide mb-4">OpsLink Servers</div>
    <div class="flex items-center gap-8 text-sm" id="navLinks">
      <a href="/" class="hover:opacity-80">Home</a>
      <a href="/servers/" class="hover:opacity-80">Browse</a>
      <a href="/submit/" class="hover:opacity-80">Submit</a>
      <a href="/messages/" class="hover:opacity-80">Messages</a>
      <a href="/support/" class="hover:opacity-80">Support</a>
      <a href="/auth/login/" id="loginBtn" class="rounded-full border border-white/20 px-4 py-2 hover:bg-white/10">Login</a>
      <a href="#" id="adminBtn" class="hidden rounded-full bg-red-600 text-white px-6 py-3 hover:bg-red-700">Admin Dashboard</a>
    </div>
  </nav>

  <!-- Hero Section -->
  <section class="relative px-10 pt-16 pb-40 text-center">
    <h1 class="max-w-3xl mx-auto text-5xl font-bold leading-tight">
      The <span class="text-white">curated</span> Discord server directory, <br />
      trusted, moderated, and high quality.
    </h1>

    <p class="mt-6 max-w-xl mx-auto text-zinc-300">
      OpsLink Servers lists only verified Discord communities.
      Every server is manually approved. Every review is moderated.
      No spam. No fake ratings.
    </p>

<div class="mt-10 flex justify-center flex-wrap gap-4">
  <a href="/servers/" class="rounded-full bg-white text-black px-6 py-3 hover:bg-zinc-200">Browse Servers</a>
  <a href="/submit/" class="rounded-full border border-white text-white px-6 py-3 hover:bg-white/10">Submit Server</a>
  <a href="https://www.dropbox.com/scl/fi/x720hcdvuvvrd8ocikqzz/OpsLink-Servers-Setup-1.0.0.exe?rlkey=mu2n2k9wgyz0xb48qmue28dv6&st=fwno1m7f&dl=1" 
     class="rounded-full bg-indigo-600 text-white px-6 py-3 hover:bg-indigo-700">
    Desktop App
  </a>
  <a href="#" id="adminBtnHero" class="hidden rounded-full bg-red-600 text-white px-6 py-3 hover:bg-red-700">Admin Dashboard</a>
</div>


    <!-- Live Stats Inline -->
    <p class="mt-10 text-2xl md:text-3xl font-semibold text-white">
      Discover <span id="memberCount" class="text-white">0</span> users across <span id="serverCount" class="text-white">0</span> communities
    </p>
  </section>

  <!-- Feature Cards -->
  <section class="px-10 pb-32 grid grid-cols-1 md:grid-cols-3 gap-6">
    <div class="bg-zinc-900/80 border border-zinc-800 p-6 text-white hover:scale-105 transition-transform">
      <h3 class="text-lg font-semibold mb-2">Manually Approved</h3>
      <p class="text-sm text-zinc-300">Every server is reviewed by our team before being listed.</p>
    </div>
    <div class="bg-zinc-900/80 border border-zinc-800 p-6 text-white hover:scale-105 transition-transform">
      <h3 class="text-lg font-semibold mb-2">Verified Reviews</h3>
      <p class="text-sm text-zinc-300">Reviews come from real Discord members, no bots, no abuse.</p>
    </div>
    <div class="bg-zinc-900/80 border border-zinc-800 p-6 text-white hover:scale-105 transition-transform">
      <h3 class="text-lg font-semibold mb-2">Quality Discovery</h3>
      <p class="text-sm text-zinc-300">Find high-quality servers without scrolling through spam.</p>
    </div>
  </section>

  <!-- Trust Section -->
  <section class="px-10 pb-32" id="reviews">
    <div class="max-w-4xl mx-auto grid grid-cols-1 md:grid-cols-3 gap-8 text-center">
      <div>
        <h4 class="font-semibold mb-1">Strict Rules</h4>
        <p class="text-sm text-zinc-300">Low-effort servers are rejected.</p>
      </div>
      <div>
        <h4 class="font-semibold mb-1">Transparent Moderation</h4>
        <p class="text-sm text-zinc-300">Clear reasons for approval or rejection.</p>
      </div>
      <div>
        <h4 class="font-semibold mb-1">Community First</h4>
        <p class="text-sm text-zinc-300">Quality over quantity, always.</p>
      </div>
    </div>
  </section>

  <!-- Footer -->
<footer class="px-10 py-10 border-t border-zinc-800 text-sm text-zinc-400 flex flex-col md:flex-row justify-between gap-4">
  <!-- Left -->
  <span>
    © 2026 OpsLink Servers. All rights reserved.
  </span>

  <!-- Right -->
  <div class="flex flex-wrap items-center gap-4">
    <a href="/support/docs/" class="hover:text-zinc-200 transition">
      Docs
    </a>
    <a href="/support/tickets/" class="hover:text-zinc-200 transition">
      Support Hub
    </a>
    <a href="/support/legal/" class="hover:text-zinc-200 transition">
      Legal
    </a>
    <span class="hidden md:inline">•</span>
    <span>
      Not affiliated with Discord Inc.
    </span>
  </div>
</footer>


<script>
const API_URL = "https://opslinkservers-backend.onrender.com";
const loginBtn = document.getElementById('loginBtn');
const adminBtn = document.getElementById('adminBtn');
const adminBtnHero = document.getElementById('adminBtnHero');
const navLinks = document.getElementById('navLinks');

const token = localStorage.getItem('token');
const userStr = localStorage.getItem('user');

if (token && userStr) {
  const user = JSON.parse(userStr);

  loginBtn.textContent = 'Logout';
  loginBtn.href = '#';
  loginBtn.addEventListener('click', () => {
    localStorage.removeItem('token');
    localStorage.removeItem('user');
    window.location.reload();
  });

  // Extract user ID from JWT (for profile link)
  let userId;
  try {
    const payload = JSON.parse(atob(token.split('.')[1]));
    userId = payload.id || payload._id;
  } catch {
    userId = user._id; // fallback
  }

 // Create dropdown container
const dropdownContainer = document.createElement('div');
dropdownContainer.className = 'relative ml-2';

// Create trigger button
const welcomeBtn = document.createElement('button');
welcomeBtn.textContent = `Welcome, ${user.discordUsername}`;
welcomeBtn.className = 'text-sm text-zinc-300 mr-2 px-2 py-1 hover:bg-white/10 rounded transition';
dropdownContainer.appendChild(welcomeBtn);

// Create dropdown menu
const dropdownMenu = document.createElement('div');
dropdownMenu.className = 'absolute right-0 mt-2 w-36 bg-zinc-900 border border-zinc-700 rounded shadow-lg text-sm text-white opacity-0 pointer-events-none transition-opacity z-50';dropdownMenu.innerHTML = `
  <a href="/profile/?id=${userId}" class="block px-4 py-2 hover:bg-zinc-700">View Profile</a>
  <a href="/settings/" class="block px-4 py-2 hover:bg-zinc-700">Settings</a>
`;
dropdownContainer.appendChild(dropdownMenu);

// Toggle dropdown on button click
welcomeBtn.addEventListener('click', (e) => {
  e.stopPropagation(); // prevent document click from closing immediately
  const isOpen = dropdownMenu.classList.contains('opacity-100');
  if (isOpen) {
    dropdownMenu.classList.remove('opacity-100');
    dropdownMenu.classList.add('opacity-0', 'pointer-events-none');
  } else {
    dropdownMenu.classList.remove('opacity-0', 'pointer-events-none');
    dropdownMenu.classList.add('opacity-100');
  }
});

// Close dropdown when clicking outside
document.addEventListener('click', () => {
  dropdownMenu.classList.remove('opacity-100');
  dropdownMenu.classList.add('opacity-0', 'pointer-events-none');
});

// Insert dropdown into nav
navLinks.insertBefore(dropdownContainer, loginBtn);

// Show admin links if applicable
if (user.role === 'admin' || user.role === 'management') {
  adminBtn.classList.remove('hidden');
  adminBtn.href = 'dashboard.html';
  adminBtnHero.classList.remove('hidden');
  adminBtnHero.href = 'dashboard.html';
}

}
// --------------------------
// Live stats
// --------------------------
function animateValue(el, start, end, duration = 1200) {
  const range = end - start;
  let startTime = null;
  function step(timestamp) {
    if (!startTime) startTime = timestamp;
    const progress = Math.min((timestamp - startTime) / duration, 1);
    el.textContent = Math.floor(start + range * progress).toLocaleString();
    if (progress < 1) requestAnimationFrame(step);
  }
  requestAnimationFrame(step);
}

const serverCountEl = document.getElementById('serverCount');
const memberCountEl = document.getElementById('memberCount');
let currentServers = 0;
let currentMembers = 0;

async function fetchLiveStats() {
  try {
    const res = await fetch(`${API_URL}/api/servers`);
    const servers = await res.json();

    const approved = servers.filter(s => s.status === 'approved' || !s.status);
    const totalServers = approved.length;
    const totalMembers = approved.reduce((sum, s) => sum + (Number(s.members) || 0), 0);

    animateValue(serverCountEl, currentServers, totalServers);
    animateValue(memberCountEl, currentMembers, totalMembers);

    currentServers = totalServers;
    currentMembers = totalMembers;
  } catch (err) {
    console.error("Error fetching live stats:", err);
  }
}

// Initial fetch + refresh every 2–5 minutes
fetchLiveStats();
setInterval(fetchLiveStats, 2.5 * 60 * 1000 + Math.random() * 2.5 * 60 * 1000);
</script>


</body>
</html>
